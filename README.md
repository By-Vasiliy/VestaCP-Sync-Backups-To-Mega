VestaCP загрузка бэкапов в облако MEGA
====

С помощью данного скрипта вы сможете автоматизировать загрузку бэкапов в облако MEGA, бесплатно предоставляющие 50GiB для пользователей. Также есть платные тарифы.

Скрипт принимает один параметр, количество бэкапов на одного пользователя. Данное число нужно рассчитывать в ручную так как на данный момент скрипт не определяет количество свободного места в облаке, и просто удаляет бэкапы если их число превышает заданное!

## Зависимости ##

Для работы скрипта необходимо установить [MegaTools](https://megatools.megous.com/)

Скрипт установки под Ubuntu:


```
#!SH
#!/bin/bash

#Необходимые пакеты
sudo apt-get -y install build-essential libglib2.0-dev libssl-dev libcurl4-openssl-dev libgirepository1.0-dev

#Выбор версии пакета
VERSION="1.9.97" #Под эту версию написан скрипт,может быть не совместим с другими версиями

#Установка самого пакета
wget http://megatools.megous.com/builds/megatools-${VERSION}.tar.gz
tar xzf megatools-${VERSION}.tar.gz 
cd megatools-${VERSION} && ./configure && make && checkinstall && ldconfig

```


## Установка скрипта ##

Необходимо разместить скрипт в папке **/usr/local/vesta/bin/**

Также необходимо создать файл **.megarc** в домашней директории root и admin со следующими данными:


```
#!SH

[Login]
Username = Your_Mega_Username
Password = Your_Mega_Password

```

Далее через панель управления Vesta создаём крон задание с командой:


```
#!SH
sudo /usr/local/vesta/bin/v-sync-backup-mega С%

```
**С% ** - Целое число бэкапов для 1 пользователя хранимое в облаке, по стандарту если не выставить число установлено 21, если у вас мало пользователей в панели и размеры бэкапов не превышают 500-800MiB то это вполне приемлемая цифра. Но рассчитывать её желательно индивидуально и периодически проверять облако.
